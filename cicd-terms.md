# ТЗ к gitlab-ci pipeline
1) Этапы выполнения:
- test: Запуск модульных и интеграционных тестов
- build: Сборка Docker-образов
- deploy-staging: Деплой на staging окружение
- deploy-production: Деплой на production окружение

2) Тестирование:
- Запускать модульные тесты при каждом push в любую ветку
- Запускать интеграционные тесты (с реальными сервисами) при изменении кода приложения
- Генерировать отчет о покрытии кода (code coverage)
- Сохранять результаты тестов как артефакты

3) Сборка:
- Собирать Docker-образ для основного приложения
- Собирать Docker-образ для тестового окружения
- Пушить образы в Docker Hub с тегами (commit SHA)

4) Деплой:
- Staging:
  - Автоматический деплой при мерже в ветку main
  - Использовать docker-compose для развертывания
  - Обеспечить zero-downtime deployment
- Production:
  - Запускать только при создании тега

5) Безопасность:
- Сканировать Docker-образы на уязвимости (Trivy)

6) Уведомления:
- Отправлять уведомления в Telegram при:
  - Падении тестов
  - Запуске и результате деплоя на staging
  - Запуске и результате деплоя на production
